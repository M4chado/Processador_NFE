{% extends "base.html" %}

{% block content %}
<div class="container">
    <header class="mb-4">
        <h1>Extração de Dados de Nota Fiscal</h1>
        <p class="text-muted">Carregue um PDF de nota fiscal e extraia os dados automaticamente usando IA.</p>
    </header>

    <div class="card p-4 shadow-sm">
        <form action="/upload" method="post" enctype="multipart/form-data" class="upload-form text-center">
            
            <label for="pdf_file" class="d-block p-5 border rounded bg-light position-relative" style="cursor: pointer; border-style: dashed !important; transition: background 0.3s;">
                
                <i id="upload-icon" class="fa-solid fa-cloud-arrow-up fa-3x text-primary mb-3"></i>
                <i id="document-icon" class="fa-solid fa-file-pdf fa-3x text-danger mb-3" style="display: none;"></i>
                
                <br>
                <span id="upload-text" class="fw-bold text-secondary">Clique aqui para selecionar o arquivo PDF</span>
            </label>
            
            <input type="file" name="pdf_file" id="pdf_file" accept=".pdf" required style="display: none;">
            
            <div id="file-name-display" class="mt-3 fw-bold text-success" style="min-height: 24px;"></div>
            
            <button type="submit" class="btn btn-primary btn-lg w-100 mt-3 shadow-sm">
                <i class="fa-solid fa-bolt me-2"></i> Extrair Dados
            </button>
        </form>

        <hr class="my-4 text-muted">

        <a href="/chat" class="btn btn-secondary w-100 py-2">
            <i class="fa-solid fa-comments-dollar me-2"></i> Acessar o Chat com Banco de Dados
        </a>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const pdfFileInput = document.getElementById('pdf_file');
        const fileNameDisplay = document.getElementById('file-name-display');
        
        const uploadIcon = document.getElementById('upload-icon');
        const documentIcon = document.getElementById('document-icon');
        const uploadText = document.getElementById('upload-text');

        if(pdfFileInput) {
            pdfFileInput.addEventListener('change', () => {
                if (pdfFileInput.files.length > 0) {
                    // Arquivo selecionado
                    fileNameDisplay.textContent = `Arquivo selecionado: ${pdfFileInput.files[0].name}`;
                    
                    // Troca os ícones
                    uploadIcon.style.display = 'none';
                    uploadText.style.display = 'none';
                    documentIcon.style.display = 'inline-block';
                } else {
                    // Seleção cancelada
                    fileNameDisplay.textContent = '';
                    
                    // Restaura ícones originais
                    uploadIcon.style.display = 'inline-block';
                    uploadText.style.display = 'inline-block';
                    documentIcon.style.display = 'none';
                }
            });
        }
    });
</script>
{% endblock %}